# 4.4. アドオンをBlender本体に取り込んでもらうまでの流れ

そのような方のために本書最後の節では、作成したアドオンを公開する方法について紹介します。

## Blender本体に取り込まれる条件

[1.2節](../chapter_01/02_Use_Blender_Add-on.md) ではアドオンのサポートレベルについて紹介しましたが、Blender本体に取り込んでもらうためには *Release* または *Contrib* のサポートレベルになる必要があります。
なお *Contrib* のサポートレベルではビルド時のBlenderのみしかインストールされないため、公式にリリースされたBlenderへ取り込んでもらうためには、 *Release* のサポートレベルになる必要がります。

ここでは、作成したアドオンを *Release* または *Contrib* のサポートレベルにするまでの過程を紹介したいと思います。

## Blender本体に取り込んでもらうまでの流れ

### アドオンの機能が既に存在するか確認する

作成したアドオンの機能について、Blender本体や *Release* または *Contrib* のサポートレベルであるアドオンの中に同じまたは非常によく似ている機能がないか確認しましょう。
*Release* または *Contrib* のサポートレベルであるアドオンは以下から参照できます。

* Blender Wiki (Blender Add-ons Catalog) - http://wiki.blender.org/index.php/Extensions:2.6/Py/Scripts

もし作成したアドオンの機能が存在しない場合は、Blender本体に登録される可能性が高くなります。
しかし既に同様の機能があるアドオンが存在した場合でも、諦めるのはまだ早いです。
公開されているアドオンに性能面や機能面で問題点や改善点がないか確認してみましょう。
公開されているアドオンを改善すれば、作成したアドオンをBlender本体へ登録してもらえる可能性があります。
もちろん公開されているアドオンについて何も進展がないようなアドオンでは、Blender本体への登録は厳しいと思います。

### Blenderアドオンのコーディング規約を守る

Blender本体として公開するということは、言い換えれば **Blenderのソフトウェアの1つとして公開される** ことと同じになるため、アドオンのソース自体の品質的にも一定以上のものが求められます。
このため、Blender本体にアドオンを取り込んでもらうためには、ソースコード作成時に品質を意識して作成する必要があります。

品質をあげるといっても何をすれば良く分からないと思いますが、コーディング規約を守るように心がければ良いと思います。
もしコーディング規約が守られていなかった場合でも、後のソースコードレビューで指摘されて直す必要が出てくると思いますが、アドオン作成時にも意識しておくことが重要です。

Blenderアドオンのコーディング規約は、Pythonのコーディング規約であるpep8に準拠しています。
以下のサイトからpep8に沿っているか確認しながら、アドオンを作成しましょう。
なお、1行の最大文字数が79文字を超えてはならないpep8-80というのもありますが、ここまでは求められていないようです。

* PEP 0008 -- Style Guide for Python Code - https://www.python.org/dev/peps/pep-0008/


コーティング規約だけでなく、Blender本体に取り込まれるアドオンは処理も効率的でなくてはなりません。
アドオンを使う人にとっては、少しでも速く処理が終わったほうが良いのは考えてみれば当然です。
Blenderはアドオン開発について、処理を効率的に処理するために必要なベストプラクティスと呼ばれる記事を用意しています。
ベストプラクティスを参照し、効率的なコーディングを心がけましょう。

* Best Practice (API documentation - Blender 2.75a) - https://www.blender.org/api/blender_python_api_2_75a_release/info_best_practice.html

効率的なコーディングの実例を1つ紹介します。

リストに格納された値を2倍にしたリストを作成する、以下のソースコードを見てください。

```py: best_practice_before.py
>>> l = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
>>> double_l = []
>>> for i in l:
...    double_l.append(i * 2)
...
>>> double_l
[2, 4, 6, 8, 10, 12, 14, 16, 18, 20]
```
これをPythonの機能であるリスト内包表記で書くと、以下のようになります。

```py: best_practice_after.py
>>> l = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
>>> double_l = [i * 2 for i in l]
[2, 4, 6, 8, 10, 12, 14, 16, 18, 20]
```

最終結果はどちらも同じですが、リスト内包表記を用いた場合の方が実行速度が速いです。
最初の例では **append属性を取り出して関数を呼び出す** という関数の呼び出し処理を ```append()``` 関数を呼び出すたびに行っているのに対して、リスト内包表記を用いた例では **リストに要素を追加する** という処理（関数を呼び出さず直接リストに要素を追加する処理）になるからです。

### アドオンの機能レビューを受ける


### Bleder Wikiページの作成


### アドオンのソースコードレビューを受ける


### Blenderリポジトリへの登録


### サポートページの開設


### サポートレベル Release への審査


## まとめ

### ポイント

* 作成したアドオンをBlender本体に取り込んでもらうためには、ソースコードレビューやWikiページ作成など数多くの準備が必要である
